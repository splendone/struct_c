<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>线性表顺序存储结构 - 插入删除操作动画演示</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #333;
        }
        .animation-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px 0;
        }
        .memory-display {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #fafafa;
        }
        .memory-cell {
            width: 60px;
            height: 60px;
            border: 2px solid #333;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            position: relative;
            transition: all 0.3s ease;
        }
        .memory-cell.index {
            background-color: #e0e0e0;
            font-size: 12px;
        }
        .memory-cell.value {
            background-color: #4CAF50;
            color: white;
        }
        .memory-cell.empty {
            background-color: #f9f9f9;
            color: #999;
        }
        .memory-cell.highlight {
            background-color: #FFC107;
            color: #333;
            transform: scale(1.1);
            box-shadow: 0 0 10px rgba(255, 193, 7, 0.5);
        }
        .memory-cell.inserting {
            background-color: #2196F3;
            color: white;
        }
        .memory-cell.deleting {
            background-color: #f44336;
            color: white;
        }
        .controls {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }
        button {
            padding: 10px 15px;
            font-size: 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            background-color: #008CBA;
            color: white;
        }
        button:hover {
            background-color: #005f73;
        }
        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        .code-display {
            margin: 20px 0;
            padding: 15px;
            background-color: #2d2d2d;
            color: #f8f8f2;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            white-space: pre;
            overflow-x: auto;
        }
        .code-line {
            margin: 5px 0;
        }
        .current-line {
            background-color: #444;
        }
        .info-panel {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        .input-section {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .legend-color {
            width: 20px;
            height: 20px;
            border: 1px solid #333;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>线性表顺序存储结构 - 插入删除操作动画演示</h1>
        
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background-color: #4CAF50;"></div>
                <span>已存储元素</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #f9f9f9;"></div>
                <span>空闲位置</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #FFC107;"></div>
                <span>当前操作位置</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #2196F3;"></div>
                <span>插入元素</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #f44336;"></div>
                <span>删除元素</span>
            </div>
        </div>

        <div class="animation-container">
            <div class="memory-display" id="memoryDisplay">
                <!-- 内存单元格将通过JavaScript生成 -->
            </div>
        </div>

        <div class="info-panel">
            <h3>当前状态信息</h3>
            <p>列表长度: <span id="listLength">0</span> / 最大容量: <span id="maxCapacity">10</span></p>
            <p>当前数组: <span id="currentArray">[]</span></p>
        </div>

        <div class="input-section">
            <input type="number" id="positionInput" placeholder="位置" min="0" max="10">
            <input type="number" id="valueInput" placeholder="值" min="0">
            <button onclick="insertElement()">插入元素</button>
            <button onclick="deleteElement()">删除元素</button>
            <button onclick="resetList()">重置列表</button>
        </div>

        <div class="controls">
            <button onclick="demoInsert()">插入演示</button>
            <button onclick="demoDelete()">删除演示</button>
            <button onclick="autoDemo()">自动演示</button>
        </div>

        <div class="code-display" id="codeDisplay">
            <!-- 代码将通过JavaScript显示 -->
        </div>
    </div>

    <script>
        // 线性表数据结构
        const MAX_SIZE = 10;
        let linearList = [];
        let animationSpeed = 800; // 动画速度（毫秒）
        let isAnimating = false;

        // 初始化显示
        function initDisplay() {
            renderMemory();
            updateInfoPanel();
            showCode('init');
        }

        // 渲染内存显示
        function renderMemory() {
            const container = document.getElementById('memoryDisplay');
            container.innerHTML = '';
            
            // 添加索引行
            for (let i = 0; i < MAX_SIZE; i++) {
                const indexCell = document.createElement('div');
                indexCell.className = 'memory-cell index';
                indexCell.textContent = i;
                container.appendChild(indexCell);
            }
            
            // 添加值行
            for (let i = 0; i < MAX_SIZE; i++) {
                const valueCell = document.createElement('div');
                valueCell.className = 'memory-cell value';
                valueCell.id = `cell-${i}`;
                
                if (i < linearList.length) {
                    valueCell.textContent = linearList[i];
                    valueCell.classList.add('value');
                } else {
                    valueCell.textContent = '-';
                    valueCell.classList.add('empty');
                }
                
                container.appendChild(valueCell);
            }
        }

        // 更新信息面板
        function updateInfoPanel() {
            document.getElementById('listLength').textContent = linearList.length;
            document.getElementById('currentArray').textContent = '[' + linearList.join(', ') + ']';
        }

        // 高亮指定位置
        function highlightPosition(position, className = 'highlight') {
            const cell = document.getElementById(`cell-${position}`);
            if (cell) {
                cell.classList.remove('highlight', 'inserting', 'deleting');
                cell.classList.add(className);
            }
        }

        // 移除高亮
        function removeHighlight() {
            for (let i = 0; i < MAX_SIZE; i++) {
                const cell = document.getElementById(`cell-${i}`);
                if (cell) {
                    cell.classList.remove('highlight', 'inserting', 'deleting');
                }
            }
        }

        // 插入元素
        async function insertElement() {
            if (isAnimating) return;
            
            const position = parseInt(document.getElementById('positionInput').value);
            const value = parseInt(document.getElementById('valueInput').value);
            
            if (isNaN(position) || isNaN(value)) {
                alert('请输入有效的位置和值！');
                return;
            }
            
            if (position < 0 || position > linearList.length) {
                alert(`位置必须在 0 到 ${linearList.length} 之间！`);
                return;
            }
            
            if (linearList.length >= MAX_SIZE) {
                alert('线性表已满，无法插入！');
                return;
            }
            
            isAnimating = true;
            
            // 显示插入操作的代码
            showCode('insert', { position, value });
            
            // 高亮插入位置
            highlightPosition(position, 'inserting');
            await sleep(animationSpeed);
            
            // 如果插入位置不是末尾，需要移动元素
            if (position < linearList.length) {
                // 从后往前移动元素
                for (let i = linearList.length - 1; i >= position; i--) {
                    linearList[i + 1] = linearList[i];
                    renderMemory();
                    highlightPosition(i, 'highlight');
                    highlightPosition(i + 1, 'inserting');
                    await sleep(animationSpeed);
                }
            }
            
            // 插入新元素
            linearList[position] = value;
            renderMemory();
            highlightPosition(position, 'value');
            await sleep(animationSpeed);
            removeHighlight();
            
            updateInfoPanel();
            isAnimating = false;
        }

        // 删除元素
        async function deleteElement() {
            if (isAnimating) return;
            
            const position = parseInt(document.getElementById('positionInput').value);
            
            if (isNaN(position)) {
                alert('请输入有效的位置！');
                return;
            }
            
            if (position < 0 || position >= linearList.length) {
                alert(`位置必须在 0 到 ${linearList.length - 1} 之间！`);
                return;
            }
            
            isAnimating = true;
            
            // 显示删除操作的代码
            showCode('delete', { position });
            
            // 高亮删除位置
            highlightPosition(position, 'deleting');
            await sleep(animationSpeed);
            
            // 记录被删除的值
            const deletedValue = linearList[position];
            
            // 从删除位置开始，向前移动元素
            for (let i = position; i < linearList.length - 1; i++) {
                linearList[i] = linearList[i + 1];
                renderMemory();
                highlightPosition(i + 1, 'highlight');
                highlightPosition(i, 'value');
                await sleep(animationSpeed);
            }
            
            // 移除最后一个元素
            linearList.pop();
            renderMemory();
            await sleep(animationSpeed);
            removeHighlight();
            
            updateInfoPanel();
            isAnimating = false;
        }

        // 重置列表
        function resetList() {
            if (isAnimating) return;
            linearList = [];
            renderMemory();
            updateInfoPanel();
            showCode('init');
        }

        // 演示插入操作
        async function demoInsert() {
            if (isAnimating) return;
            
            resetList();
            await sleep(500);
            
            // 演示插入操作
            document.getElementById('positionInput').value = '0';
            document.getElementById('valueInput').value = '10';
            await insertElement();
            
            await sleep(500);
            document.getElementById('positionInput').value = '0';
            document.getElementById('valueInput').value = '20';
            await insertElement();
            
            await sleep(500);
            document.getElementById('positionInput').value = '1';
            document.getElementById('valueInput').value = '15';
            await insertElement();
        }

        // 演示删除操作
        async function demoDelete() {
            if (isAnimating) return;
            
            // 先填充一些数据
            linearList = [20, 15, 10, 30, 40];
            renderMemory();
            updateInfoPanel();
            
            await sleep(1000);
            
            // 演示删除操作
            document.getElementById('positionInput').value = '1';
            await deleteElement();
        }

        // 自动演示
        async function autoDemo() {
            if (isAnimating) return;
            
            resetList();
            await sleep(1000);
            
            // 插入演示
            await demoInsert();
            await sleep(1000);
            
            // 删除演示
            await demoDelete();
        }

        // 显示代码
        function showCode(operation, params = {}) {
            let code = '';
            
            switch(operation) {
                case 'init':
                    code = `// 初始化线性表
#define MAXSIZE 10
int list[MAXSIZE];
int length = 0;`;
                    break;
                    
                case 'insert':
                    code = `// 在位置 ${params.position} 插入元素 ${params.value}
Status ListInsert(SqList &L, int i, ElemType e) {
    if (i < 1 || i > L.length + 1)  // 检查位置是否合法
        return ERROR;
    if (L.length >= MAXSIZE)        // 检查是否已满
        return ERROR;
    
    for (int j = L.length; j >= i; j--) // 移动元素
        L.elem[j] = L.elem[j-1];
    
    L.elem[i-1] = e;                // 插入元素
    L.length++;                     // 长度加1
    
    return OK;
}`;
                    break;
                    
                case 'delete':
                    code = `// 删除位置 ${params.position} 的元素
Status ListDelete(SqList &L, int i, ElemType &e) {
    if (i < 1 || i > L.length)      // 检查位置是否合法
        return ERROR;
    
    e = L.elem[i-1];                // 保存被删除的元素
    
    for (int j = i; j < L.length; j++) // 移动元素
        L.elem[j-1] = L.elem[j];
    
    L.length--;                     // 长度减1
    
    return OK;
}`;
                    break;
            }
            
            document.getElementById('codeDisplay').textContent = code;
        }

        // 延时函数
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // 初始化页面
        window.onload = function() {
            initDisplay();
        };
    </script>
</body>
</html>